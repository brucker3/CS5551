{% extends 'base.html' %}
{% load static %}
{% block content %}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <a class="navbar-brand" href="#">Checkers Board</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
      <li class="nav-item active">
          <a class="nav-link" href={%url 'home'%}>Home</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href={%url 'rules'%}>rules</a>
      </li>
      <li class="nav-item">
          <a class="nav-link" href={%url 'player_stats'%}>player states</a>
      </li>

      <li class="nav-item" style="right:130px; position:absolute">
        <span class="nav-link">Welcome, {{request.user}}</span>
      </li>

      <li class="nav-item" style="right:20px; position:absolute">
        <a class="nav-link" href={%url 'logout'%}>logout</a>
      </li>


    </ul>
  </div>
</nav>

	<form action="/game/createGame/" method="post" >
		{% csrf_token %}
		
		<input type="checkbox" id="aiplayer" name="aiplayer">
			<label for="aiplayer"> check this box if you want to play aganis the  ai </label><br><br>
			<button id="create-game" type="submit" value="submit">CREATE GAME</button><br>
	</form>
			
	<form action="/game/resumeGame/" method="post" style="border-style: ridge;">
		{% csrf_token %}
	Your Started Games:
	  <div id="my-games-list-radio"></div>
	  <button id="resume-game" type="submit" value="submit" disabled>RESUME GAME</button><br>
	</form>
	
	<form action="/game/joinGame/" method="post" style="border-style: ridge;">
		{% csrf_token %}
	Open to Join Games:
	  <div id="active-games-list-radio"></div>
	  <button id="join-game" type="submit" value="submit" disabled>JOIN GAME</button><br>
	</form>
	
	{{ all_active_game_data|json_script:"all-active-games-data" }}
	{{ my_active_games|json_script:"my-games-data" }}
    <script>		
		let active_game_data_dict = JSON.parse(document.getElementById('all-active-games-data').textContent);
		let my_game_data_dict = JSON.parse(document.getElementById('my-games-data').textContent);
        console.log(active_game_data_dict,my_game_data_dict);

		var dom_my_games = document.getElementById('my-games-list-radio');
		for (var i in my_game_data_dict) {
			document.getElementById('resume-game').disabled = false;
			dom_my_games.innerHTML += ('<label><input type="radio" name="game-id" value="' + i + '" checked/> ' +
											'created by user:  <b>'+my_game_data_dict[i][0]+ '</b>' );
			if (my_game_data_dict[i][1]==''){
				dom_my_games.innerHTML += (' and waiting for other player to join');
			}else {
				dom_my_games.innerHTML += (' joined by <b>'+my_game_data_dict[i][1]+'</b>');
			}
			dom_my_games.innerHTML += ('  <i>(gameid: '+i+')</i></label><br>');
		  } 
		
		var dom_my_games = document.getElementById('active-games-list-radio');
		for (var i in active_game_data_dict) {
			document.getElementById('join-game').disabled = false;
			dom_my_games.innerHTML += ('<label><input type="radio" name="game-id" value="' + i + '" checked/> ' + 
										'created by user:  '+active_game_data_dict[i] +
										'  <i>(gameid: '+i+')</i></label><br>');
		}
		//var aigame = document.getElementById('aiplayer')
		//document.querySelector('#create-game').onclick = function(e) {
        //    window.location.pathname = '/game/createGame/';
       // };
    </script>

{% endblock %}
